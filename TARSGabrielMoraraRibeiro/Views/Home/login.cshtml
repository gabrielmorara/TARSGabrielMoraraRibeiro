@{
    ViewData["Title"] = "Login";
}

<style>

    label {
        font-weight: bold
    }

    .container {
        width: 100%
    }

    .common_box_body {
        padding: 15px;
        border: 12px solid #3ca85c;
        border-color: #28BAA2;
        border-radius: 15px;
        margin-top: 10px;
        background: #f2fff6;
    }
</style>

<div class="container">
    <div class="panel panel-default">
        <div class="common_box_body panel-body">
            <div class="col-md-6">
                <span class="login100-form-logo">
                    <i class="zmdi zmdi-landscape"></i>
                </span>
                <h1>Bem-vindo</h1>
                <p>Faça seu login para continuar.</p>
                <div class="ibox-content">
                    <form role="form">
                        <div class="form-group">
                            <span>CPF: </span>
                            <input type="text" id="cpf" name="cpf" class="form-control" data-bind="value: cpf" onkeydown="javascript: fMasc( this, mCPF );">
                        </div>
                        <div class="form-group">
                            <span>Senha: </span>
                            <input type="password" class="form-control" data-bind="value: password">
                        </div>
                        <div class="form-group">
                            <div class="row align-items-center">
                                <button class="btn btn-primary" data-bind="click: authenticateUser">Entrar</button>
                            </div>
                            <br />
                            <div>
                                <p>ou</p>
                            </div>
                            <div>
                                <a class="btn btn-sm btn-blue " href="register">Criar uma conta.</a>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <hr>
</div>

<script type="text/javascript">

    function ViewModel() {
        try {

            var self = this;

            self.cpf = ko.observable("");
            self.password = ko.observable("");

            self.authenticateUser = () => {
                $.ajax({
                    type: "POST",
                    url: '/Users/AuthenticateUser',
                    data: {
                        cpf: self.cpf(),
                        password: self.password()
                    },
                    success: function (response) {
                        console.log(response);
                        setCookie('UserCPF', self.cpf());
                        setCookie('UserToken', response);
                        window.location.href = '/Home/Index';
                    },
                    error: function (response) {
                        console.log('Erro' + response);
                    }
                });
            }
        } catch (e) {
            console.log(e);
        }
    }

    var vm = new ViewModel();

    // ativa knockout.js
    ko.applyBindings(vm);

</script>
